#if defined(GW_SENSE) || !defined(GATEWAY)
#include <xnode.h>
#include <string.h>
#include <sdmalloc.h>
#include "filter_o.h"
#include "arm_math.h"

// this code is for offline downsampling, we need to merge it the code with oneline sampling.

static const float b_2[order_2+1] = {
-0.0000134464222012,
-0.0000315706951085,
0.0000411549216921,
0.0003331428468394,
0.0007434585243887,
0.0008113244369012,
0.0001886245095210,
-0.0006415439208966,
-0.0006131017694453,
0.0004578943282211,
0.0011315744304753,
0.0000970362318757,
-0.0014907423863906,
-0.0010539267945878,
0.0013848469318882,
0.0022458756397273,
-0.0005389244173381,
-0.0032939067357321,
-0.0011556367294454,
0.0036715070399213,
0.0035301522600615,
-0.0028311971754584,
-0.0060744596111775,
0.0003876458389752,
0.0079618754411489,
0.0036851255113819,
-0.0081825413611626,
-0.0089030593918958,
0.0057640213609113,
0.0142134410869341,
-0.0000322031958227,
-0.0180462888610926,
-0.0091499410039150,
0.0184515822193632,
0.0212358313149094,
-0.0132158686476425,
-0.0349958733816804,
-0.0003375026733484,
0.0486830058708111,
0.0268889475384590,
-0.0603381898868885,
-0.0820367526213193,
0.0681720330545237,
0.3099336464090930,
0.4290669749733253,
0.3099336464090930,
0.0681720330545237,
-0.0820367526213193,
-0.0603381898868885,
0.0268889475384590,
0.0486830058708111,
-0.0003375026733484,
-0.0349958733816804,
-0.0132158686476425,
0.0212358313149094,
0.0184515822193632,
-0.0091499410039150,
-0.0180462888610926,
-0.0000322031958227,
0.0142134410869341,
0.0057640213609113,
-0.0089030593918958,
-0.0081825413611626,
0.0036851255113819,
0.0079618754411489,
0.0003876458389752,
-0.0060744596111775,
-0.0028311971754584,
0.0035301522600615,
0.0036715070399213,
-0.0011556367294454,
-0.0032939067357321,
-0.0005389244173381,
0.0022458756397273,
0.0013848469318882,
-0.0010539267945878,
-0.0014907423863906,
0.0000970362318757,
0.0011315744304753,
0.0004578943282211,
-0.0006131017694453,
-0.0006415439208966,
0.0001886245095210,
0.0008113244369012,
0.0007434585243887,
0.0003331428468394,
0.0000411549216921,
-0.0000315706951085,
-0.0000134464222012
};
static const float b_3[order_3+1] = {
	-0.0000026294719428,
-0.0000022504800768,
0.0000155695529837,
0.0000755018426165,
0.0001967879166443,
0.0003675102145471,
0.0005253823851911,
0.0005700343177753,
0.0004178884997865,
0.0000769215791460,
-0.0003133222566796,
-0.0005289483234961,
-0.0003970881423413,
0.0000559661366747,
0.0005616075132089,
0.0007444956170756,
0.0003859391722672,
-0.0003608395261172,
-0.0009954758267957,
-0.0009843424521889,
-0.0001845541528264,
0.0009432574977023,
0.0015645986929456,
0.0010643826757417,
-0.0003991344781875,
-0.0018487059494614,
-0.0021069318158484,
-0.0007174188844984,
0.0015280403334585,
0.0029782365854462,
0.0022996857847321,
-0.0003676229619539,
-0.0032350179553292,
-0.0040104672501187,
-0.0016781763875204,
0.0024318109781893,
0.0052983671096596,
0.0043704520170904,
-0.0002646490310503,
-0.0054838434718357,
-0.0071430344089684,
-0.0032798009006595,
0.0039081347274011,
0.0091369298617872,
0.0078115798901459,
-0.0001127409448167,
-0.0093111682363044,
-0.0124957821792226,
-0.0060043622566201,
0.0065834199493499,
0.0160663485567295,
0.0140805292117136,
0.0000484444201409,
-0.0168702935261083,
-0.0232930024139527,
-0.0115891165855624,
0.0127244807404575,
0.0324687556606646,
0.0297859237079190,
0.0001698520736391,
-0.0402896643057191,
-0.0609878291175447,
-0.0343073641266625,
0.0455496425819354,
0.1546662512449777,
0.2488169613639572,
0.2859292318069895,
0.2488169613639572,
0.1546662512449777,
0.0455496425819354,
-0.0343073641266625,
-0.0609878291175447,
-0.0402896643057191,
0.0001698520736391,
0.0297859237079190,
0.0324687556606646,
0.0127244807404575,
-0.0115891165855624,
-0.0232930024139527,
-0.0168702935261083,
0.0000484444201409,
0.0140805292117136,
0.0160663485567295,
0.0065834199493499,
-0.0060043622566201,
-0.0124957821792226,
-0.0093111682363044,
-0.0001127409448167,
0.0078115798901459,
0.0091369298617872,
0.0039081347274011,
-0.0032798009006595,
-0.0071430344089684,
-0.0054838434718357,
-0.0002646490310503,
0.0043704520170904,
0.0052983671096596,
0.0024318109781893,
-0.0016781763875204,
-0.0040104672501187,
-0.0032350179553292,
-0.0003676229619539,
0.0022996857847321,
0.0029782365854462,
0.0015280403334585,
-0.0007174188844984,
-0.0021069318158484,
-0.0018487059494614,
-0.0003991344781875,
0.0010643826757417,
0.0015645986929456,
0.0009432574977023,
-0.0001845541528264,
-0.0009843424521889,
-0.0009954758267957,
-0.0003608395261172,
0.0003859391722672,
0.0007444956170756,
0.0005616075132089,
0.0000559661366747,
-0.0003970881423413,
-0.0005289483234961,
-0.0003133222566796,
0.0000769215791460,
0.0004178884997865,
0.0005700343177753,
0.0005253823851911,
0.0003675102145471,
0.0001967879166443,
0.0000755018426165,
0.0000155695529837,
-0.0000022504800768,
-0.0000026294719428
};
static const float b_5[order_5+1] = {
-0.0000011949163994,
-0.0000008926742640,
0.0000013788781992,
0.0000084639499871,
0.0000236014920221,
0.0000500146818616,
0.0000897918589438,
0.0001425509740050,
0.0002042560050160,
0.0002666619761048,
0.0003178266674028,
0.0003439508305923,
0.0003324455958358,
0.0002756958333236,
0.0001745944640569,
0.0000407154793608,
-0.0001039373532915,
-0.0002301649629670,
-0.0003076337802332,
-0.0003126649362071,
-0.0002358748965350,
-0.0000874167123148,
0.0001022430890016,
0.0002871321346630,
0.0004158787821891,
0.0004451554392051,
0.0003531452623061,
0.0001490734221340,
-0.0001246719279902,
-0.0003997114335011,
-0.0005975431923365,
-0.0006508123929469,
-0.0005245253088633,
-0.0002309030330452,
0.0001675078705312,
0.0005691281600275,
0.0008577881117255,
0.0009349009753800,
0.0007508613170669,
0.0003261718225487,
-0.0002454171834820,
-0.0008151208885068,
-0.0012160684712083,
-0.0013103828158753,
-0.0010336038351793,
-0.0004228174776278,
0.0003819774007652,
0.0011669901788844,
0.0016992569421308,
0.0017934805507730,
0.0013725419818373,
0.0005028185958912,
-0.0006091937729678,
-0.0016624024061050,
-0.0023399618821491,
-0.0024016085405727,
-0.0017633767289400,
-0.0005394694815635,
0.0009703649983255,
0.0023500787882173,
0.0031785799529339,
0.0031542476364050,
0.0021969399616421,
0.0004947080145319,
-0.0015244538047000,
-0.0032951288082107,
-0.0042683303780953,
-0.0040760988733653,
-0.0026589471994184,
-0.0003145106870314,
0.0023549518957085,
0.0045907065595894,
0.0056868795991474,
0.0052049624600967,
0.0031304319663005,
-0.0000806021337484,
-0.0035893721639442,
-0.0063843387750013,
-0.0075630757807120,
-0.0066101778615913,
-0.0035889805492172,
0.0008178310183681,
0.0054457243556554,
0.0089415098862801,
0.0101421967894929,
0.0084376830919265,
0.0040100716134026,
-0.0021325799311246,
-0.0083592623582662,
-0.0128221847325987,
-0.0139711348857758,
-0.0110407162886926,
-0.0043690423431317,
0.0045606965129456,
0.0133983830179076,
0.0194836498415583,
0.0205597942637038,
0.0154692614496504,
0.0046430347878880,
-0.0097669292476218,
-0.0241837059878173,
-0.0342972847240260,
-0.0360165425056210,
-0.0264698503908090,
-0.0048156986801058,
0.0273444224927234,
0.0660747796852817,
0.1057414703001686,
0.1400570130359701,
0.1633144183243991,
0.1715409927055251,
0.1633144183243991,
0.1400570130359701,
0.1057414703001686,
0.0660747796852817,
0.0273444224927234,
-0.0048156986801058,
-0.0264698503908090,
-0.0360165425056210,
-0.0342972847240260,
-0.0241837059878173,
-0.0097669292476218,
0.0046430347878880,
0.0154692614496504,
0.0205597942637038,
0.0194836498415583,
0.0133983830179076,
0.0045606965129456,
-0.0043690423431317,
-0.0110407162886926,
-0.0139711348857758,
-0.0128221847325987,
-0.0083592623582662,
-0.0021325799311246,
0.0040100716134026,
0.0084376830919265,
0.0101421967894929,
0.0089415098862801,
0.0054457243556554,
0.0008178310183681,
-0.0035889805492172,
-0.0066101778615913,
-0.0075630757807120,
-0.0063843387750013,
-0.0035893721639442,
-0.0000806021337484,
0.0031304319663005,
0.0052049624600967,
0.0056868795991474,
0.0045907065595894,
0.0023549518957085,
-0.0003145106870314,
-0.0026589471994184,
-0.0040760988733653,
-0.0042683303780953,
-0.0032951288082107,
-0.0015244538047000,
0.0004947080145319,
0.0021969399616421,
0.0031542476364050,
0.0031785799529339,
0.0023500787882173,
0.0009703649983255,
-0.0005394694815635,
-0.0017633767289400,
-0.0024016085405727,
-0.0023399618821491,
-0.0016624024061050,
-0.0006091937729678,
0.0005028185958912,
0.0013725419818373,
0.0017934805507730,
0.0016992569421308,
0.0011669901788844,
0.0003819774007652,
-0.0004228174776278,
-0.0010336038351793,
-0.0013103828158753,
-0.0012160684712083,
-0.0008151208885068,
-0.0002454171834820,
0.0003261718225487,
0.0007508613170669,
0.0009349009753800,
0.0008577881117255,
0.0005691281600275,
0.0001675078705312,
-0.0002309030330452,
-0.0005245253088633,
-0.0006508123929469,
-0.0005975431923365,
-0.0003997114335011,
-0.0001246719279902,
0.0001490734221340,
0.0003531452623061,
0.0004451554392051,
0.0004158787821891,
0.0002871321346630,
0.0001022430890016,
-0.0000874167123148,
-0.0002358748965350,
-0.0003126649362071,
-0.0003076337802332,
-0.0002301649629670,
-0.0001039373532915,
0.0000407154793608,
0.0001745944640569,
0.0002756958333236,
0.0003324455958358,
0.0003439508305923,
0.0003178266674028,
0.0002666619761048,
0.0002042560050160,
0.0001425509740050,
0.0000897918589438,
0.0000500146818616,
0.0000236014920221,
0.0000084639499871,
0.0000013788781992,
-0.0000008926742640,
-0.0000011949163994
};
static const float b_10[order_10+1] = {
-0.0000007316882455,
-0.0000001909425457,
0.0000001028338986,
0.0000007642366903,
0.0000019493471557,
0.0000038418879325,
0.0000066438995573,
0.0000105650067850,
0.0000158081144000,
0.0000225510291331,
0.0000309241002933,
0.0000409916111671,
0.0000527324192125,
0.0000660122449747,
0.0000805788595443,
0.0000960443136932,
0.0001118880664786,
0.0001274625018565,
0.0001420115814726,
0.0001547004531796,
0.0001646540796159,
0.0001710064253564,
0.0001729576199742,
0.0001698346576383,
0.0001611512945361,
0.0001466681954546,
0.0001264390526384,
0.0001008490524315,
0.0000706311892452,
0.0000368649582076,
0.0000009492632556,
-0.0000354488148618,
-0.0000704699451721,
-0.0001021590919555,
-0.0001285811321637,
-0.0001479463883476,
-0.0001587401659054,
-0.0001598477309199,
-0.0001506637406254,
-0.0001311792602807,
-0.0001020351352466,
-0.0000645365632184,
-0.0000206236283523,
0.0000272054638188,
0.0000760158797185,
0.0001225990320632,
0.0001636683462036,
0.0001960777416116,
0.0002170477565406,
0.0002243860383947,
0.0002166827632518,
0.0001934687777321,
0.0001553177966790,
0.0001038842259235,
0.0000418661074858,
-0.0000271083355686,
-0.0000986701375129,
-0.0001679653526282,
-0.0002299656977370,
-0.0002798138089954,
-0.0003131823584899,
-0.0003266207220104,
-0.0003178634478897,
-0.0002860753300745,
-0.0002320103392640,
-0.0001580662434311,
-0.0000682242383489,
0.0000321312931814,
0.0001365069160454,
0.0002376957935925,
0.0003282517256543,
0.0004010131606596,
0.0004496409513990,
0.0004691327837236,
0.0004562726770289,
0.0004099805775893,
0.0003315272110550,
0.0002245916614054,
0.0000951452103278,
-0.0000488395802333,
-0.0001978458486434,
-0.0003414108310903,
-0.0004688321203717,
-0.0005699346079512,
-0.0006358468245610,
-0.0006597286423273,
-0.0006373943318868,
-0.0005677778120044,
-0.0004531966081243,
-0.0002993821019229,
-0.0001152605906527,
0.0000875146274762,
0.0002952590907629,
0.0004931439882819,
0.0006662185022292,
0.0008005007773370,
0.0008840595470311,
0.0009080070569424,
0.0008673230138685,
0.0007614405802020,
0.0005945356431207,
0.0003754829398073,
0.0001174620529867,
-0.0001627756951147,
-0.0004459451914204,
-0.0007115088143880,
-0.0009391208269370,
-0.0011101352604520,
-0.0012090702199002,
-0.0012249165078495,
-0.0011521861117307,
-0.0009916081088738,
-0.0007504022817010,
-0.0004420870058647,
-0.0000858119940202,
0.0002947606166697,
0.0006729664884287,
0.0010209500022466,
0.0013116563258585,
0.0015208672365017,
0.0016291311734068,
0.0016234400952047,
0.0014985147938922,
0.0012575848842637,
0.0009125787225284,
0.0004836807067133,
-0.0000017442677507,
-0.0005108101585010,
-0.0010072603913640,
-0.0014539739411290,
-0.0018156602575706,
-0.0020615518569559,
-0.0021678964913814,
-0.0021200537415824,
-0.0019140224746524,
-0.0015572576882211,
-0.0010686823333128,
-0.0004778532653722,
0.0001766975484605,
0.0008498650004705,
0.0014929740198254,
0.0020571923813593,
0.0024971206192078,
0.0027743037234109,
0.0028604014492798,
0.0027397681546087,
0.0024112229225509,
0.0018888417569841,
0.0012016655239098,
0.0003922939355816,
-0.0004855856922194,
-0.0013706038963872,
-0.0021978446940923,
-0.0029034425236980,
-0.0034293268207937,
-0.0037277731065340,
-0.0037654191537182,
-0.0035264260259561,
-0.0030145124026126,
-0.0022536584891334,
-0.0012873641132600,
-0.0001764441172511,
0.0010045493243010,
0.0021720852072316,
0.0032393048137991,
0.0041222001243709,
0.0047458975215478,
0.0050505979835792,
0.0049967271273798,
0.0045688847552610,
0.0037782487829643,
0.0026631835929721,
0.0012879177211419,
-0.0002607118010048,
-0.0018783150257757,
-0.0034495357612141,
-0.0048557801662179,
-0.0059835973056939,
-0.0067331529846745,
-0.0070262029894190,
-0.0068129788864227,
-0.0060774452451646,
-0.0048404746332192,
-0.0031606074783268,
-0.0011322145733565,
0.0011189516135023,
0.0034426525321294,
0.0056731684121723,
0.0076399153441360,
0.0091790461821866,
0.0101453107712048,
0.0104234005055696,
0.0099380000531237,
0.0086618192703542,
0.0066209772962255,
0.0038972560062219,
0.0006269208425874,
-0.0030039843740590,
-0.0067677412888057,
-0.0104061104986074,
-0.0136439800000807,
-0.0162047757267102,
-0.0178267649639572,
-0.0182792967571452,
-0.0173779954597741,
-0.0149979553026170,
-0.0110840769439791,
-0.0056578348950591,
0.0011800389378464,
0.0092512383771970,
0.0183059606159268,
0.0280331449716431,
0.0380743868985868,
0.0480408147107194,
0.0575320289570284,
0.0661560689996455,
0.0735492965833380,
0.0793950774360617,
0.0834402004002797,
0.0855080960376338,
0.0855080960376338,
0.0834402004002797,
0.0793950774360617,
0.0735492965833380,
0.0661560689996455,
0.0575320289570284,
0.0480408147107194,
0.0380743868985868,
0.0280331449716431,
0.0183059606159268,
0.0092512383771970,
0.0011800389378464,
-0.0056578348950591,
-0.0110840769439791,
-0.0149979553026170,
-0.0173779954597741,
-0.0182792967571452,
-0.0178267649639572,
-0.0162047757267102,
-0.0136439800000807,
-0.0104061104986074,
-0.0067677412888057,
-0.0030039843740590,
0.0006269208425874,
0.0038972560062219,
0.0066209772962255,
0.0086618192703542,
0.0099380000531237,
0.0104234005055696,
0.0101453107712048,
0.0091790461821866,
0.0076399153441360,
0.0056731684121723,
0.0034426525321294,
0.0011189516135023,
-0.0011322145733565,
-0.0031606074783268,
-0.0048404746332192,
-0.0060774452451646,
-0.0068129788864227,
-0.0070262029894190,
-0.0067331529846745,
-0.0059835973056939,
-0.0048557801662179,
-0.0034495357612141,
-0.0018783150257757,
-0.0002607118010048,
0.0012879177211419,
0.0026631835929721,
0.0037782487829643,
0.0045688847552610,
0.0049967271273798,
0.0050505979835792,
0.0047458975215478,
0.0041222001243709,
0.0032393048137991,
0.0021720852072316,
0.0010045493243010,
-0.0001764441172511,
-0.0012873641132600,
-0.0022536584891334,
-0.0030145124026126,
-0.0035264260259561,
-0.0037654191537182,
-0.0037277731065340,
-0.0034293268207937,
-0.0029034425236980,
-0.0021978446940923,
-0.0013706038963872,
-0.0004855856922194,
0.0003922939355816,
0.0012016655239098,
0.0018888417569841,
0.0024112229225509,
0.0027397681546087,
0.0028604014492798,
0.0027743037234109,
0.0024971206192078,
0.0020571923813593,
0.0014929740198254,
0.0008498650004705,
0.0001766975484605,
-0.0004778532653722,
-0.0010686823333128,
-0.0015572576882211,
-0.0019140224746524,
-0.0021200537415824,
-0.0021678964913814,
-0.0020615518569559,
-0.0018156602575706,
-0.0014539739411290,
-0.0010072603913640,
-0.0005108101585010,
-0.0000017442677507,
0.0004836807067133,
0.0009125787225284,
0.0012575848842637,
0.0014985147938922,
0.0016234400952047,
0.0016291311734068,
0.0015208672365017,
0.0013116563258585,
0.0010209500022466,
0.0006729664884287,
0.0002947606166697,
-0.0000858119940202,
-0.0004420870058647,
-0.0007504022817010,
-0.0009916081088738,
-0.0011521861117307,
-0.0012249165078495,
-0.0012090702199002,
-0.0011101352604520,
-0.0009391208269370,
-0.0007115088143880,
-0.0004459451914204,
-0.0001627756951147,
0.0001174620529867,
0.0003754829398073,
0.0005945356431207,
0.0007614405802020,
0.0008673230138685,
0.0009080070569424,
0.0008840595470311,
0.0008005007773370,
0.0006662185022292,
0.0004931439882819,
0.0002952590907629,
0.0000875146274762,
-0.0001152605906527,
-0.0002993821019229,
-0.0004531966081243,
-0.0005677778120044,
-0.0006373943318868,
-0.0006597286423273,
-0.0006358468245610,
-0.0005699346079512,
-0.0004688321203717,
-0.0003414108310903,
-0.0001978458486434,
-0.0000488395802333,
0.0000951452103278,
0.0002245916614054,
0.0003315272110550,
0.0004099805775893,
0.0004562726770289,
0.0004691327837236,
0.0004496409513990,
0.0004010131606596,
0.0003282517256543,
0.0002376957935925,
0.0001365069160454,
0.0000321312931814,
-0.0000682242383489,
-0.0001580662434311,
-0.0002320103392640,
-0.0002860753300745,
-0.0003178634478897,
-0.0003266207220104,
-0.0003131823584899,
-0.0002798138089954,
-0.0002299656977370,
-0.0001679653526282,
-0.0000986701375129,
-0.0000271083355686,
0.0000418661074858,
0.0001038842259235,
0.0001553177966790,
0.0001934687777321,
0.0002166827632518,
0.0002243860383947,
0.0002170477565406,
0.0001960777416116,
0.0001636683462036,
0.0001225990320632,
0.0000760158797185,
0.0000272054638188,
-0.0000206236283523,
-0.0000645365632184,
-0.0001020351352466,
-0.0001311792602807,
-0.0001506637406254,
-0.0001598477309199,
-0.0001587401659054,
-0.0001479463883476,
-0.0001285811321637,
-0.0001021590919555,
-0.0000704699451721,
-0.0000354488148618,
0.0000009492632556,
0.0000368649582076,
0.0000706311892452,
0.0001008490524315,
0.0001264390526384,
0.0001466681954546,
0.0001611512945361,
0.0001698346576383,
0.0001729576199742,
0.0001710064253564,
0.0001646540796159,
0.0001547004531796,
0.0001420115814726,
0.0001274625018565,
0.0001118880664786,
0.0000960443136932,
0.0000805788595443,
0.0000660122449747,
0.0000527324192125,
0.0000409916111671,
0.0000309241002933,
0.0000225510291331,
0.0000158081144000,
0.0000105650067850,
0.0000066438995573,
0.0000038418879325,
0.0000019493471557,
0.0000007642366903,
0.0000001028338986,
-0.0000001909425457,
-0.0000007316882455
};

void filter(float *input, float *output, unsigned int number_input, unsigned int rate)
{
	float32_t *filtered_data = NULL, *sdtemp = NULL, *sd_first = NULL;
	unsigned int i, k = 0, g = 0;
	float32_t  *inputF32, *outputF32;
	arm_fir_instance_f32 S;

	/* choose filter coefficient according to decimation rate */
	switch (rate) {
		case 2:
			lpc_printf("Decimation rate is 2.\r\n");
			filtered_data=(float32_t*)sdcalloc(number_input, sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input+order_2), sizeof(float32_t));
		  sd_first=(float32_t*)sdcalloc(0, sizeof(float32_t));
			configASSERT(filtered_data && sdtemp && sd_first);
			inputF32 = &input[0];
      outputF32 = &filtered_data[0];
	    /* Initialize and process */
      arm_fir_init_f32(&S, order_2+1 , (float32_t *)&b_2[0], &sdtemp[0], number_input);
      arm_fir_f32(&S, inputF32, outputF32, number_input);
			// down sample
	    for (i = order_2;  i < number_input ; ++i) {
	       if ((i-order_2) % rate == 0) {
		      output[k++] = (float)filtered_data[i];
		     }
      }		  
		  break;
			
		case 3:
			lpc_printf("Decimation rate is 3.\r\n");
			filtered_data=(float32_t*)sdcalloc(number_input, sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input+order_3), sizeof(float32_t));
		  sd_first=(float32_t*)sdcalloc(0, sizeof(float32_t));
			configASSERT(filtered_data && sdtemp && sd_first);			
			inputF32 = &input[0];
      outputF32 = &filtered_data[0];
	    /* Initialize and process */
      arm_fir_init_f32(&S, order_3+1 , (float32_t *)&b_3[0], &sdtemp[0], number_input);
      arm_fir_f32(&S, inputF32, outputF32, number_input);
			// down sample
	    for (i = order_3;  i < number_input; ++i) {
	       if ((i-order_3) % rate == 0) {
		      output[k++] = (float)filtered_data[i];
		     }
      }	
		  break;
		
		case 5:
			lpc_printf("Decimation rate is 5.\r\n");
			filtered_data=(float32_t*)sdcalloc(number_input, sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input+order_5), sizeof(float32_t));
		  sd_first=(float32_t*)sdcalloc(0, sizeof(float32_t));
			configASSERT(filtered_data && sdtemp && sd_first);			
			inputF32 = &input[0];
      outputF32 = &filtered_data[0];
	    /* Initialize and process */
      arm_fir_init_f32(&S, order_5+1 , (float32_t *)&b_5[0], &sdtemp[0], number_input);
      arm_fir_f32(&S, inputF32, outputF32, number_input);
			// down sample
	    for (i = order_5;  i < number_input; ++i) {
	       if ((i-order_5) % rate == 0) {
		      output[k++] = (float)filtered_data[i];
		     }
      }
		  break;
			
		case 10:
			lpc_printf("Decimation rate is 10.\r\n");
			filtered_data=(float32_t*)sdcalloc(number_input, sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input+order_10), sizeof(float32_t));
		  sd_first=(float32_t*)sdcalloc(0, sizeof(float32_t));
			configASSERT(filtered_data && sdtemp && sd_first);
			inputF32 = &input[0];
      outputF32 = &filtered_data[0];
	    /* Initialize and process */
      arm_fir_init_f32(&S, order_10+1 , (float32_t *)&b_10[0], &sdtemp[0], number_input);
      arm_fir_f32(&S, inputF32, outputF32, number_input);
			// down sample
	    for (i = order_10;  i < number_input; ++i) {
	       if ((i-order_10) % rate == 0) {
		      output[k++] = (float)filtered_data[i];
		     }
      }
		  break;
			
		case 20:
			lpc_printf("Decimation rate is 20.\r\n");
			filtered_data=(float32_t*)sdcalloc(number_input, sizeof(float32_t));
		  sd_first=(float32_t*)sdcalloc((number_input/10), sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input+order_10), sizeof(float32_t));
			configASSERT(filtered_data && sdtemp && sd_first);			
			inputF32 = &input[0];
      outputF32 = &filtered_data[0];
		/* Decomate @ rate of 10 */
	    /* Initialize and process */
      arm_fir_init_f32(&S, order_10+1 , (float32_t *)&b_10[0], &sdtemp[0], number_input);
      arm_fir_f32(&S, inputF32, outputF32, number_input);
		  // down sample
	    for (i = order_10;  i < number_input; ++i) {
	       if ((i-order_10) % 10 == 0) {
		      sd_first[k++] = (float)filtered_data[i];
		     }
			 }
		/* Decimate at rate of 2 */
			filtered_data=(float32_t*)sdcalloc(number_input/10, sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input/10+order_2), sizeof(float32_t));
			configASSERT(filtered_data && sdtemp);			
  	  inputF32 = &sd_first[0];
			outputF32 = &filtered_data[0];
			/* Initialize and process */
      arm_fir_init_f32(&S, order_2+1 , (float32_t *)&b_2[0], &sdtemp[0], number_input/10);
			arm_fir_f32(&S, inputF32, outputF32, number_input/10);
			// down sample 
	    for (i = order_2;  i < (number_input-order_10)/10; ++i) {
	       if ((i-order_2) % 2 == 0) {
		      output[g++] = (float)filtered_data[i];
		     }
      }
		  break;
			
		case 50:
			lpc_printf("Decimation rate is 50.\r\n");
			filtered_data=(float32_t*)sdcalloc(number_input, sizeof(float32_t));
		  sd_first=(float32_t*)sdcalloc((number_input/10), sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input+order_10), sizeof(float32_t));
			configASSERT(filtered_data && sdtemp && sd_first);			
			inputF32 = &input[0];
      outputF32 = &filtered_data[0];
		/* Decomate @ rate of 10 */
	    /* Initialize and process */
      arm_fir_init_f32(&S, order_10+1 , (float32_t *)&b_10[0], &sdtemp[0], number_input);
      arm_fir_f32(&S, inputF32, outputF32, number_input);
		  // down sample
	    for (i = order_10;  i < number_input; ++i) {
	       if ((i-order_10) % 10 == 0) {
		      sd_first[k++] = (float)filtered_data[i];
		     }
			 }
		/* Decimate at rate of 5 */
			filtered_data=(float32_t*)sdcalloc(number_input/10, sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input/10+order_5), sizeof(float32_t));
			configASSERT(filtered_data && sdtemp);			
  	  inputF32 = &sd_first[0];
			outputF32 = &filtered_data[0];
			/* Initialize and process */
      arm_fir_init_f32(&S, order_5+1 , (float32_t *)&b_5[0], &sdtemp[0], number_input/10);
			arm_fir_f32(&S, inputF32, outputF32, number_input/10);
			// down sample 
	    for (i = order_5;  i < (number_input-order_10)/10; ++i) {
	       if ((i-order_5) % 5 == 0) {
		      output[g++] = (float)filtered_data[i];
		     }
      }
		  break;
			
		case 100:
			lpc_printf("Decimation rate is 100.\r\n");
			filtered_data=(float32_t*)sdcalloc(number_input, sizeof(float32_t));
		  sd_first=(float32_t*)sdcalloc((number_input/10), sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input+order_10), sizeof(float32_t));
			configASSERT(filtered_data && sdtemp && sd_first);			
			inputF32 = &input[0];
      outputF32 = &filtered_data[0];
		/* Decomate @ rate of 10 */
	    /* Initialize and process */
      arm_fir_init_f32(&S, order_10+1 , (float32_t *)&b_10[0], &sdtemp[0], number_input);
      arm_fir_f32(&S, inputF32, outputF32, number_input);
		  // down sample
	    for (i = order_10;  i < number_input; ++i) {
	       if ((i-order_10) % 10 == 0) {
		      sd_first[k++] = (float)filtered_data[i];
		     }
			 }
		/* Decimate at rate of 10 again */
			filtered_data=(float32_t*)sdcalloc(number_input/10, sizeof(float32_t));
			sdtemp=(float32_t*)sdcalloc((number_input/10+order_10), sizeof(float32_t));
			configASSERT(filtered_data && sdtemp);			
  	  inputF32 = &sd_first[0];
			outputF32 = &filtered_data[0];
			/* Initialize and process */
      arm_fir_init_f32(&S, order_10+1 , (float32_t *)&b_10[0], &sdtemp[0], number_input/10);
			arm_fir_f32(&S, inputF32, outputF32, number_input/10);
			// down sample 
	    for (i = order_10;  i < (number_input-order_10)/10; ++i) {
	       if ((i-order_10) % 10 == 0) {
		      output[g++] = (float)filtered_data[i];
		     }
      }
			break;
			
		default:
		  lpc_printf("Invalid decimation rate.\r\n");
		  break;
	}
		sdfree(filtered_data);
	  sdfree(sd_first);
	  sdfree(sdtemp);
}
#endif
